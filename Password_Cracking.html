<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Password Cracking Investigation Report – A Cracking Christmas (Day 9)</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap');

    body { margin: 0; padding: 0; background: #0f111a; color: #a0aabf; font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .container {
        max-width: 210mm;
        margin: 0 auto;
        padding: 40px;
        background: #0f111a;
        min-height: 100vh;
        border-top: 5px solid #00d4ff;
    }

    h1, h2, h3, h4 { color: #ffffff; letter-spacing: .5px; }
    h1 { font-size: 26px; border-bottom: 2px solid #2d3648; padding-bottom: 15px; margin-bottom: 25px; text-transform: uppercase; }
    h2 { color: #00d4ff; font-size: 18px; margin-top: 30px; border-left: 4px solid #00d4ff; padding-left: 12px; text-transform: uppercase; }
    h3 { font-size: 14px; color: #e2e8f0; margin-top: 22px; font-weight: 700; }
    h4 { font-size: 13px; margin-top: 15px; }

    p { font-size: 13px; line-height: 1.6; }
    ul { padding-left: 20px; font-size: 13px; }
    li { margin-bottom: 5px; }

    .meta-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 25px;
        background: #1a1f2e;
        padding: 20px;
        border-radius: 4px;
        border: 1px solid #2d3648;
    }
    .meta-item strong { color: #64748b; font-size: 10px; display:block; text-transform: uppercase; margin-bottom: 4px; }
    .meta-item span { color: #fff; font-weight: 600; font-size: 14px; }
    .severity-med { color:#facc15!important; }
    .severity-high { color:#f97373!important; }

    .code-block {
        background-color: #020617;
        border: 1px solid #1f2937;
        border-left: 4px solid #f97316;
        color: #e5e7eb;
        font-family: 'JetBrains Mono', monospace;
        padding: 12px;
        margin: 10px 0 18px;
        border-radius: 4px;
        font-size: 12px;
        white-space: pre-wrap;
    }

    table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 12px; }
    th { background: #2d3648; color: #fff; padding: 8px; text-align: left; border: 1px solid #3f4c6b; }
    td { background: #151921; border: 1px solid #2d3648; padding: 8px; color: #cbd5e1; vertical-align: top; }

    .remediation-box { border: 1px solid #3f4c6b; padding: 14px; background: #111827; margin-bottom: 12px; border-radius: 4px; }
    .remediation-header { color: #00d4ff; font-weight: 700; margin-bottom: 8px; display: block; }

    .tag-pill {
        display:inline-block;
        padding:2px 7px;
        border-radius:999px;
        background:#1f2937;
        border:1px solid #374151;
        font-size:10px;
        text-transform:uppercase;
        letter-spacing:.06em;
        color:#9ca3af;
        margin-right:4px;
        margin-bottom:4px;
    }

    @media print {
        body { margin: 0; }
        .container { width: 100%; max-width: none; margin: 0; }
        .page-break { page-break-before: always; }
    }
</style>
</head>
<body>
<div class="container">
    <div style="text-align:right;font-size:10px;color:#64748b;margin-bottom:10px;">// CONFIDENTIAL</div>

    <h1>Password Cracking Investigation Report<br>
        <span style="font-size:16px;color:#64748b;text-transform:none;">Encrypted Files – “A Cracking Christmas” (Advent of Cyber 2025 – Day 9)</span>
    </h1>

    <div style="background:#1f2937;color:#e5e7eb;padding:14px 16px;border-left:4px solid #f97316;margin-bottom:25px;font-size:13px;">
        This report documents the analysis and cracking of weakly protected encrypted files (PDF and ZIP) in a controlled lab environment, focusing on attacker methodology and defender detection strategies.
    </div>

    <div class="meta-grid">
        <div class="meta-item">
            <strong>Case ID</strong>
            <span>AOC-2025-PASS-IR-009</span>
        </div>
        <div class="meta-item">
            <strong>Analyst</strong>
            <span>[Shubharyan Asthana]</span>
        </div>
        <div class="meta-item">
            <strong>Scenario</strong>
            <span>North Pole Asset List – Encrypted Files</span>
        </div>
        <div class="meta-item">
            <strong>Assessment</strong>
            <span class="severity-med">Weak password-protected archives – Offline crackable</span>
        </div>
    </div>

    <h2>1. Lab Overview & Objectives</h2>

    <h3>1.1 Context</h3>
    <p>
        As part of TryHackMe’s <strong>Advent of Cyber 2025</strong>, the TBFC environment contained encrypted files 
        labelled <em>“North Pole Asset List”</em> (PDF and ZIP). The goal was to simulate how an attacker would recover 
        poorly protected data and how a SOC team could detect and respond to offline password-cracking activity.
    </p>

    <h3>1.2 Objectives</h3>
    <ul>
        <li>Understand how password-based encryption protects files such as PDFs and ZIP archives.</li>
        <li>Use dictionary-based attacks to recover weak passwords in a controlled environment.</li>
        <li>Compare techniques for PDF vs ZIP encrypted data.</li>
        <li>Identify detection opportunities and telemetry for password-cracking tools.</li>
        <li>Translate findings into practical defensive measures and recommendations.</li>
    </ul>

    <h2>2. Environment & Methodology</h2>

    <h3>2.1 Lab Environment</h3>
    <ul>
        <li><strong>Platform:</strong> TryHackMe Linux VM (Ubuntu-based) – Advent of Cyber 2025, Day 9.</li>
        <li><strong>User:</strong> <code>ubuntu</code></li>
        <li><strong>Working directory:</strong> <code>~/Desktop</code></li>
        <li><strong>Tools used:</strong> 
            <span class="tag-pill">file</span>
            <span class="tag-pill">pdfcrack</span>
            <span class="tag-pill">john</span>
            <span class="tag-pill">zip2john</span>
            <span class="tag-pill">rockyou.txt</span>
        </li>
    </ul>

    <h3>2.2 High-Level Workflow</h3>
    <ol>
        <li>Identify file types using the <code>file</code> command.</li>
        <li>Select appropriate cracking tools based on file format (PDF vs ZIP).</li>
        <li>Run a <strong>dictionary attack</strong> using <code>rockyou.txt</code> against both files.</li>
        <li>Decrypt the files once the password is recovered and extract the embedded flags.</li>
        <li>Review detection surfaces for cracking tools and operations.</li>
    </ol>

    <h3>2.3 File Type Identification</h3>
    <div class="code-block">
ubuntu@tryhackme:~/Desktop$ file flag.pdf
flag.pdf: PDF document, version 1.7

ubuntu@tryhackme:~/Desktop$ file flag.zip
flag.zip: Zip archive data, at least v2.0 to extract
    </div>
    <p>
        This confirmed the presence of an encrypted <strong>PDF</strong> and an encrypted <strong>ZIP</strong> archive, requiring 
        different tooling and cracking approaches.
    </p>

    <div class="page-break"></div>

    <h2>3. Password Attack – Encrypted PDF</h2>

    <h3>3.1 Tooling & Approach</h3>
    <ul>
        <li><strong>Tool:</strong> <code>pdfcrack</code></li>
        <li><strong>Mode:</strong> Dictionary attack using <code>rockyou.txt</code></li>
        <li><strong>Goal:</strong> Recover user password protecting <code>flag.pdf</code> and reveal the flag.</li>
    </ul>

    <h3>3.2 Command Execution</h3>
    <div class="code-block">
ubuntu@tryhackme:~/Desktop$ pdfcrack -f flag.pdf -w /usr/share/wordlists/rockyou.txt
PDF version 1.7
Security Handler: Standard
V: 2
R: 3
P: -1060
Length: 128
Encrypted Metadata: True
...
found user-password: '**********'
    </div>
    <p>
        The password was found within the <code>rockyou.txt</code> wordlist, illustrating how a weak or common password 
        makes otherwise strong encryption effectively useless.
    </p>

    <h3>3.3 Decryption Outcome</h3>
    <p>
        After unlocking and viewing the decrypted PDF, the following flag was recovered:
    </p>
    <div class="code-block">
Flag (PDF): THM{Cr4ck1ng_PDFs_1s_34$y}
    </div>

    <p>
        In a real-world scenario, this would represent sensitive business data (e.g., asset lists, credentials, 
        internal documentation) exposed due to weak password hygiene.
    </p>

    <h2>4. Password Attack – Encrypted ZIP</h2>

    <h3>4.1 Tooling & Approach</h3>
    <ul>
        <li><strong>Tools:</strong> <code>zip2john</code> + <code>john</code></li>
        <li><strong>Mode:</strong> Dictionary attack using <code>rockyou.txt</code></li>
        <li><strong>Goal:</strong> Recover the password protecting <code>flag.zip</code>, then extract the embedded content.</li>
    </ul>

    <h3>4.2 Hash Extraction & Cracking</h3>
    <div class="code-block">
# Extract ZIP hash for John
ubuntu@tryhackme:~/Desktop$ zip2john flag.zip > ziphash.txt

# Run John with rockyou wordlist
ubuntu@tryhackme:~/Desktop$ john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 128/128 AVX 4x])
...
PASSWORD_FOUND   (flag.zip/flag.txt)
Session completed.
    </div>
    <p>
        Once again, a dictionary-based approach was sufficient to recover the password, emphasizing that the 
        <strong>practical strength</strong> of encryption is bound to password quality.
    </p>

    <h3>4.3 Decryption Outcome</h3>
    <p>
        After extracting the archive with the recovered password, the following flag was obtained:
    </p>
    <div class="code-block">
Flag (ZIP): THM{Cr4ck1n6_z1p$_1s_34$yyyy}
    </div>

    <p>
        In production environments, such ZIP archives might contain internal files, backups, or exports that are 
        assumed to be “safe” simply because they are encrypted—despite using guessable passwords.
    </p>

    <div class="page-break"></div>

    <h2>5. Threat & Detection Analysis</h2>

    <h3>5.1 Offline Cracking Characteristics</h3>
    <p>
        A key property of password-based encryption is that once an attacker has a copy of the encrypted file, 
        they can attempt to guess the password <strong>offline</strong>. No login portals or rate limits are involved, 
        so traditional account lockout protections do not help.
    </p>

    <h3>5.2 Common Tools & Behaviours</h3>
    <p>Typical password-cracking activity involves:</p>
    <ul>
        <li>Known binaries and utilities:
            <span class="tag-pill">john</span>
            <span class="tag-pill">hashcat</span>
            <span class="tag-pill">fcrackzip</span>
            <span class="tag-pill">pdfcrack</span>
            <span class="tag-pill">zip2john</span>
            <span class="tag-pill">pdf2john</span>
        </li>
        <li>Use of large wordlists such as <code>rockyou.txt</code> or custom lists.</li>
        <li>High CPU/GPU utilisation during cracking sessions.</li>
        <li>Repeated reads of the same encrypted file and wordlist file.</li>
    </ul>

    <h3>5.3 Endpoint Telemetry</h3>
    <ul>
        <li><strong>Process Creation:</strong> Monitor execution of cracking tools and unusual CLI arguments 
            (e.g. <code>--wordlist</code>, <code>-w</code>, <code>--mask</code>, <code>-a 3</code>, references to <code>rockyou.txt</code>).</li>
        <li><strong>Config & Potfiles:</strong> Presence or modification of files like 
            <code>~/.john/john.pot</code> or <code>.hashcat/hashcat.potfile</code>.</li>
        <li><strong>GPU Artefacts:</strong> Long-running GPU-heavy processes named <code>hashcat</code> / <code>john</code>, 
            abnormal power usage and fan speed on servers not intended for GPU workloads.</li>
        <li><strong>File Access:</strong> High-frequency reads of specific encrypted archives and wordlists.</li>
    </ul>

    <h3>5.4 Network Signals</h3>
    <p>
        Although offline cracking does not require continuous network access, supporting actions often leave clues:
    </p>
    <ul>
        <li>Downloading large wordlists (e.g., <code>rockyou.txt</code>) or cloning wordlist repositories.</li>
        <li>Installing cracking tools via package managers or pulling GPU drivers and runtimes for compute workloads.</li>
    </ul>

    <h2>6. MITRE ATT&amp;CK Mapping</h2>

    <table>
        <thead>
            <tr><th>Stage</th><th>Technique</th><th>ID</th><th>Evidence</th></tr>
        </thead>
        <tbody>
            <tr>
                <td>Credential Access</td>
                <td>Password Cracking</td>
                <td>T1110.002</td>
                <td>Use of <code>pdfcrack</code> and <code>john</code> with wordlists against encrypted files.</td>
            </tr>
            <tr>
                <td>Collection</td>
                <td>Archive Collected Data</td>
                <td>T1074</td>
                <td>Encrypted PDF/ZIP representing packaged sensitive data.</td>
            </tr>
            <tr>
                <td>Defense Evasion</td>
                <td>Offline Credential Cracking</td>
                <td>(Derived)</td>
                <td>No direct login attempts, avoiding account lockout and SIEM login alerts.</td>
            </tr>
        </tbody>
    </table>

    <h2>7. Key Lessons & Recommendations</h2>

    <div class="remediation-box">
        <span class="remediation-header">Password & Encryption Hygiene</span>
        <ul>
            <li>Use <strong>long, unique, randomly generated passwords</strong> for encrypted archives.</li>
            <li>Avoid legacy or weak encryption modes, especially in older ZIP tools.</li>
            <li>Where possible, leverage modern formats with strong key derivation and high iteration counts.</li>
            <li>Ensure sensitive archives are additionally protected via access controls and storage policies.</li>
        </ul>
    </div>

    <div class="remediation-box">
        <span class="remediation-header">Monitoring & Detection</span>
        <ul>
            <li>Alert on execution of known cracking tools on production servers or user endpoints.</li>
            <li>Monitor command-line usage for common cracking flags and references to well-known wordlists.</li>
            <li>Track anomalous GPU utilisation or new GPU workloads on non-ML/compute systems.</li>
            <li>Flag large wordlist downloads or unauthorized tool installations.</li>
        </ul>
    </div>

    <div class="remediation-box">
        <span class="remediation-header">Incident Response Playbook</span>
        <ul>
            <li>Isolate the host where cracking activity is observed.</li>
            <li>Capture process lists, memory samples, and relevant working directories (encrypted files, wordlists, hashes).</li>
            <li>Review which files were successfully decrypted and assess data exposure.</li>
            <li>Rotate affected passwords/keys, enforce MFA, and remediate exposed secrets.</li>
            <li>Educate users and teams about appropriate handling and storage of encrypted data and security tools.</li>
        </ul>
    </div>

    <p style="margin-top:28px;font-size:11px;color:#64748b;text-align:right;">
        Report generated as part of TryHackMe Advent of Cyber 2025 – Day 9: Passwords – A Cracking Christmas.
    </p>
</div>
</body>
</html>
